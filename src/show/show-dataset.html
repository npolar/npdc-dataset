<!DOCTYPE html>
<article flex>

  <md-card ng-if="document.draft == 'yes'">
    <md-card-content>

      <code style="background-color: red;">

        DRAFT

      </code>
    </md-card-content>
  </md-card>

  <h1 class="md-display-1">
    <npdc:edit-button></npdc:edit-button>{{document.title}}</h1>
  <h3 class="md-headline">
    <span ng-repeat="author in authors">
      <md-tooltip>{{ orgName(author.organisation, document.organisations) }}</md-tooltip>{{ author.name }}
      <span ng-if="!$last">,
      </span>
    </span>
  </h3>

  <md-card>
    <md-card-content>
      <h3 title="Use the following string to cite the dataset">Cite dataset</h3>
      <code style="background-color: yellow;">

        {{ citation  }}

      </code>
    </md-card-content>
  </md-card>

<!--<nav>
  See http://www.nature.com/articles/sdata201544
  </nav>
  -->

  <section ng-if="data.length > 0">

    <md-card>
      <md-card-content>
        <h2 class="md-title">Data</h2>

        <ul ng-repeat="link in data">
          <li>
            <a class="md-title" ng-href="{{link.href}}">{{ link.title || link.href }}</a>
            ({{link.type || 'unknown type' }})</li>
        </ul>

        <p>{{ document.rights}}
          <br/>

        </p>

        <p>{{document.licences | json }}

<!-- https://wiki.creativecommons.org/wiki/Marking_Works_Technical -->

          <div ng-if="isCCBy">

            <a href="http://creativecommons.org/licenses/by/4.0/" rel="license"><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" style="border-width:0"/></a><br/>is free t under a
            <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0
            </a>International Licence.

            <span href="http://purl.org/dc/dcmitype/Dataset" rel="dc:type">Dataset</span>
            <a href="https://creativecommons.org/licenses/by-nc/4.0/" rel="license">CC</a>
            <span property="dc:date">2006</span>.</div>

        </p>

      </md-card-content>
    </md-card>
  </section>

  <section>
    <md-card>
      <md-card-content>
        <h2 class="md-title">Data quality</h2>
        <p class="md-title">{{ document.quality }}</p>
      </md-card-content>
    </md-card>
  </section>

  <section>
    <md-card>

      <md-card-content>
        <h2 class="md-title">Links</h2>
        <p class="md-title" ng-repeat="link in links">
          <a ng-href="{{link.href}}">{{ link.title || link.href }}</a>
          {{ link.rel }}</p>
      </md-card-content>
    </md-card>

  </section>

  <section>
    <md-card>
      <md-card-content>
        <h2 class="md-display-1">Abstract</h2>
        <p style="white-space: pre-wrap;">{{document.summary }}</p>
      </md-card-content>
    </md-card>
  </section>

  <section>
    <md-card>
      <h3 class="md-display-1">Coverage</h3>
      <md-card-content>

        <div ng-repeat="c in document.coverage">
          {{ c | json }}
        </div>
      </md-card-content>
    </md-card>
  </section>

  <section>
    <md-card>
      <h3 class="md-display-1">Fieldwork</h3>
      <md-card-content>

        <div ng-repeat="a in document.activity">
          {{ a | json }}
        </div>
      </md-card-content>
    </md-card>
  </section>

  <section>
    <md-card>
      <h3 class="md-display-1">Placenames</h3>
      <md-card-content>

        <div ng-repeat="p in document.placenames">
          {{ p | json }}
        </div>
      </md-card-content>
    </md-card>
  </section>

  <section>
    <h3 class="md-display-1">People</h3>
    <md-card ng-repeat="person in document.people">

      <md-card-content>
        <h2 class="md-title">{{ person.first_name }}
          {{ person.last_name }}</h2>
        <p>
          <a ng-click="gotoAnchor('organisation-'+person.organisation)">{{ orgName(person.organisation, document.organisations) }}</a>
        </p>
        <p>
          <span ng-repeat="role in person.roles">{{ role }}
            <span ng-if="!$last">,
            </span>
          </span>
        </p>
      </md-card-content>

    </md-card>
  </section>

  <section>
    <h3 class="headline">Organisations</h3>
    <div ng-repeat="o in document.organisations">
      <md-content>
        <md-card>

          <md-card-content>
            <h2 class="md-title" id="organisation-{{ o.id }}">{{ o.name }}</h2>
            <p>{{ o.roles.join(" ")}}</p>
          </md-card-content>
          <md-chips class="md-actions" layout-align="end center" layout="row" ng-repeat="role in person.roles">

            <md-chip>{{ role }}</md-chip>
          </md-chips>

        </md-card>
      </md-content>
    </div>
  </section>

  <aside>
    <h2 class="md-display-1">Classification</h2>
    <md-card>
      Topics
      <md-card-content ng-repeat="topic in document.topics">
        <a ng-href="?q=&filter-topics={{topic}}">{{ topic }}</a>
      </md-card-content>
    </md-card>

    <md-card>
      <md-card-content>ISO Topics</md-card-content>
      <ul>
        <li ng-repeat="iso_topic in document.iso_topics">
          <a ng-href="?q=&filter-iso_topics={{iso_topic}}">{{ iso_topic }}</a>
        </li>
      </ul>
    </md-card>

    <md-card>
      Tags
      <md-card-content ng-repeat="tag in document.tags">
        <a ng-href="?q=&filter-tags={{tag}}">{{ tag }}</a>
      </md-card-content>
    </md-card>

    <md-card>
      <h3>NASA GCMD Science Keywords</h3>
      <md-card-content>

        <div ng-repeat="k in document.gcmd.sciencekeywords">
          <a href="?q=&filter-gcmd.sciencekeywords={{ k.Category}}">{{ k.Category}}</a>
          &gt;
          <a href="">{{ k.Topic}}</a>
          &gt;
          <a href="">{{ k.Term }}</a>
          &gt;
          <a href="">{{ k.Variable_Level_1}}</a>
        </div>

      </md-card-content>
    </md-card>
  </aside>

  <section>
    <md-card>

      <md-card-content>
        <h3>Metadata in other, machine readable formats</h3>
        <ul>
          <li class="md-title" ng-repeat="link in alternate">
            <a ng-href="{{link.href}}">{{ link.title || link.href }}</a>
            ({{link.type}})</li>
        </ul>
      </md-card-content>

    </md-card>
  </section>

  <section>
    <md-card>
      <md-card-content>
        <h2 class="md-display-1">Document properties</h2>
        Created
        {{document.created }}, updated to revision
        {{ document._rev.split('-')[0] }}
        on
        {{ document.updated }}

        <a ng-href="{{uri}}">{{uri}}</a>
        {{ document._rev }}
        {{ document.edits | json }}

      </md-card-content>
    </md-card>
  </section>

</article>

<aside flex>

  <md-card>

    <md-card-content>

      <ol ng-if="related.datasets.length > 0">
        Related datasets ({{related.datasets.length}})
        <li ng-if="p._score > 0.5" ng-repeat="p in related.datasets ">
          <a ng-href="{{p.id}}">{{ p.title }}</a>
          {{p._score}}</li>
      </ol>

      Related publications
      <ol>
        <li ng-if="p._score > 0.5" ng-repeat="p in related.publications ">
          <a ng-href="?q=&filter-iso_topics={{iso_topic}}">{{ unescape(p.title) }}</a>
          {{p._score}}</li>
      </ol>

      Related projects
      <ol>
        <li ng-if="p._score > 0.5" ng-repeat="p in related.projects">
          <a ng-href="?q=&filter-iso_topics={{iso_topic}}">{{ p.title }}</a>
          {{p._score}}</li>
      </ol>

    </md-card-content>

  </md-card>

</aside>

<!--</div>-->
